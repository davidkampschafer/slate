<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Bluetooth Peripheral</title>

    <link href="../../../stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../../../stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="../../../javascripts/all_nosearch.js" type="text/javascript"></script>

  </head>

  <body class="includes includes_bodhimobile includes_bodhimobile_MobileAPI includes_bodhimobile_MobileAPI_btPeripheral">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../../../images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <a class="bodhi-logo" href="http://redbookconnect.github.io"> <img src="../../../images/logo.png" /> </a>
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="bt-peripheral-module-reference">BT Peripheral Module Reference</h1>

<h2 id="overview">Overview</h2>

<p>This module used for working with Bluetooth 4.0 LE Peripherals. Now supported
only Health Thermometer and Battery Service GATT profiles.</p>

<h2 id="tasks">Tasks</h2>

<ul>
<li><code class="prettyprint">STATES</code> constant</li>
<li><code class="prettyprint">CONNECTION_STATES</code> constant</li>
<li><code class="prettyprint">peripheralInfo</code> object</li>
<li><code class="prettyprint">profilesInfo</code> object</li>
<li><code class="prettyprint">supported</code> property</li>
<li><code class="prettyprint">start</code> function</li>
<li><code class="prettyprint">stop</code> function</li>
<li><code class="prettyprint">getState</code> function</li>
<li><code class="prettyprint">startDiscovery</code> function</li>
<li><code class="prettyprint">stopDiscovery</code> function</li>
<li><code class="prettyprint">connect</code> function</li>
<li><code class="prettyprint">disconnect</code> function</li>
<li><code class="prettyprint">btPeripheral.stateChanged</code> event</li>
<li><code class="prettyprint">btPeripheral.peripheralsChanged</code> event</li>
<li><code class="prettyprint">btPeripheral.peripheralStateChanged</code> event</li>
<li><code class="prettyprint">btPeripheral.peripheralInfoChanged</code> event</li>
</ul>

<h2 id="constants">Constants</h2>

<h3 id="states">STATES</h3>

<h4 id="discussion">Discussion</h4>

<p>This enum contains all states of <a href="btPeripheral.html">BT Peripheral</a> module.</p>

<ul>
<li><em>btPeripheral.STATES.Unknown</em></li>
</ul>

<p>State unknown, update imminent.</p>

<ul>
<li><em>btPeripheral.STATES.Resetting</em></li>
</ul>

<p>The connection with the system service was momentarily lost, update imminent.</p>

<ul>
<li><em>btPeripheral.STATES.Unsupported</em></li>
</ul>

<p>The platform doesn&rsquo;t support the Bluetooth Low Energy.</p>

<ul>
<li><em>btPeripheral.STATES.Unauthorized</em></li>
</ul>

<p>The application is not authorized to use the Bluetooth Low Energy.</p>

<ul>
<li><em>btPeripheral.STATES.PoweredOff</em></li>
</ul>

<p>Bluetooth is currently powered off.</p>

<ul>
<li><em>btPeripheral.STATES.PoweredOn</em></li>
</ul>

<p>Bluetooth is currently powered on and available to use.</p>

<h3 id="connection_states">CONNECTION_STATES</h3>

<h4 id="discussion">Discussion</h4>

<p>This enum contains all variants of Peripheral connection state.</p>

<ul>
<li><em>btPeripheral.CONNECTION</em>STATES.Unknown_</li>
</ul>

<p>Unknown connection state</p>

<ul>
<li><em>btPeripheral.CONNECTION</em>STATES.Disconnected_</li>
</ul>

<p>Peripheral Device disconnected.</p>

<ul>
<li><em>btPeripheral.CONNECTION</em>STATES.Connecting_</li>
</ul>

<p>Peripheral Device in connection state.</p>

<ul>
<li><em>btPeripheral.CONNECTION</em>STATES.Connected_</li>
</ul>

<p>Peripheral Device connected.</p>

<ul>
<li><em>btPeripheral.CONNECTION</em>STATES.Disconnecting_</li>
</ul>

<p>Peripheral Device in disconnection state.</p>

<h2 id="objects">Objects</h2>

<h3 id="peripheralinfo">peripheralInfo</h3>

<h4 id="discussion">Discussion</h4>

<p>This Object contains information about Peripheral Device.</p>

<h4 id="keys">Keys</h4>

<ul>
<li>_id_required</li>
</ul>

<p>A String value. Device idenfier. Used in connect and disconnect functions.</p>

<ul>
<li>_name_required</li>
</ul>

<p>An Integer value. Device Name.</p>

<ul>
<li>_rssi_required</li>
</ul>

<p>An Integer value. Current Device RSSI.</p>

<h3 id="profilesinfo">profilesInfo</h3>

<h4 id="discussion">Discussion</h4>

<p>This Object contains information about supported GATT profiles which found on
Peripheral Device after connection established.</p>

<h4 id="keys">Keys</h4>

<ul>
<li><em>thermometer</em></li>
</ul>

<p>An Object value. Contains information from Health Thermometer GATT profile if
device supports it.</p>

<p>* <em>timestamp</em></p>

<p>A Date value. This information timestamp.</p>

<p>* <em>temp</em></p>

<p>A Float value. Current temperature.</p>

<p>* <em>measurement</em></p>

<p>A String value. Unit of temperature measure. F for Fahrenheit and C for
Celsius degrees.</p>

<p>* <em>location</em></p>

<p>A String value. Location of thermometer.</p>

<ul>
<li><em>battery</em></li>
</ul>

<p>An Object value. Contains information from Battery Service GATT profile if
device supports it.</p>

<p>* <em>level</em></p>

<p>An Integer value. Current device battery level (0-100).</p>

<p>* <em>charging</em></p>

<p>A Boolean value. <strong>true</strong> if device plugged for charger. Otherwise <strong>false</strong>.</p>

<h2 id="properties">Properties</h2>

<h3 id="supported">supported</h3>

<h4 id="discussion">Discussion</h4>

<p>Returns whether the device supports <a href="btPeripheral.html">BT Peripheral</a> module.</p>

<h4 id="sample">Sample</h4>

<p><code class="prettyprint">var supported = btPeripheral.supported;</code>  </p>

<h2 id="functions">Functions</h2>

<h3 id="start">start</h3>

<p><code class="prettyprint">btPeripheral.start( successCallback, errorCallback )</code></p>

<h4 id="discussion">Discussion</h4>

<p>Starts working with Bluetooth 4.0 LE. Developer must call this method before
using all another functions.</p>

<h4 id="arguments">Arguments</h4>

<ul>
<li><em>succesCallback</em>optional</li>
</ul>

<p>Success callback. Called when function finished without errors</p>

<p>Callback parameter is always null</p>

<ul>
<li><em>errorCallback</em>optional</li>
</ul>

<p>Error Callback. Called when function return error.</p>

<h4 id="return-value">Return Value</h4>

<ul>
<li><em><a href="kernel_promise.html">RBCPromise</a> object</em></li>
</ul>

<h4 id="sample">Sample</h4>

<p><code class="prettyprint">btPeripheral.start( function() {  
    alert(&quot;Started.&quot;);  
}, function (error) {  
    alert(&quot;code: &quot; \+ error.code + &quot;\nmessage: &quot; \+ error.message);  
});</code>  </p>

<h3 id="stop">stop</h3>

<p><code class="prettyprint">btPeripheral.stop( successCallback, errorCallback )</code></p>

<h4 id="discussion">Discussion</h4>

<p>Stops working with Bluetooth 4.0 LE. Developer must call this method when all
operations with it finished.</p>

<h4 id="arguments">Arguments</h4>

<ul>
<li><em>succesCallback</em>optional</li>
</ul>

<p>Success callback. Called when function finished without errors</p>

<p>Callback parameter is always null</p>

<ul>
<li><em>errorCallback</em>optional</li>
</ul>

<p>Error Callback. Called when function return error.</p>

<h4 id="return-value">Return Value</h4>

<ul>
<li><em><a href="kernel_promise.html">RBCPromise</a> object</em></li>
</ul>

<h4 id="sample">Sample</h4>

<p><code class="prettyprint">btPeripheral.stop( function() {  
    alert(&quot;Stopped.&quot;);  
}, function (error) {  
    alert(&quot;code: &quot; \+ error.code + &quot;\nmessage: &quot; \+ error.message);  
});</code>  </p>

<h3 id="getstate">getState</h3>

<p><code class="prettyprint">btPeripheral.getState( successCallback, errorCallback )</code></p>

<h4 id="discussion">Discussion</h4>

<p>Gets current state. Also developer can add listener for
btPeripheral.stateChanged event to receive state updates.</p>

<h4 id="arguments">Arguments</h4>

<ul>
<li><em>succesCallback</em>optional</li>
</ul>

<p>Success callback. Called when function finished without errors</p>

<p>Callback parameter is object which contains:</p>

<p>* <em>state</em> - Current state. See STATES for more info. (Integer)</p>

<ul>
<li><em>errorCallback</em>optional</li>
</ul>

<p>Error Callback. Called when function return error.</p>

<h4 id="return-value">Return Value</h4>

<ul>
<li><em><a href="kernel_promise.html">RBCPromise</a> object</em></li>
</ul>

<h4 id="sample">Sample</h4>

<p><code class="prettyprint">btPeripheral.getState( function(info) {  
    alert(&quot;Current state: &quot;+info.state);  
}, function (error) {  
    alert(&quot;code: &quot; \+ error.code + &quot;\nmessage: &quot; \+ error.message);  
});</code>  </p>

<h3 id="startdiscovery">startDiscovery</h3>

<p><code class="prettyprint">btPeripheral.startDiscovery( successCallback, errorCallback )</code></p>

<h4 id="discussion">Discussion</h4>

<p>Starts scanning for peripherals. Developer can add listener for
btPeripheral.peripheralsChanged event to receive updates of peripherals list</p>

<h4 id="arguments">Arguments</h4>

<ul>
<li><em>succesCallback</em>optional</li>
</ul>

<p>Success callback. Called when function finished without errors</p>

<p>Callback parameter is always null</p>

<ul>
<li><em>errorCallback</em>optional</li>
</ul>

<p>Error Callback. Called when function return error.</p>

<h4 id="return-value">Return Value</h4>

<ul>
<li><em><a href="kernel_promise.html">RBCPromise</a> object</em></li>
</ul>

<h4 id="sample">Sample</h4>

<p><code class="prettyprint">btPeripheral.startDiscovery( function() {  
    alert(&quot;Discovery Started.&quot;);  
}, function (error) {  
    alert(&quot;code: &quot; \+ error.code + &quot;\nmessage: &quot; \+ error.message);  
});</code>  </p>

<h3 id="stopdiscovery">stopDiscovery</h3>

<p><code class="prettyprint">btPeripheral.stopDiscovery( successCallback, errorCallback )</code></p>

<h4 id="discussion">Discussion</h4>

<p>Stops scanning for peripherals.</p>

<h4 id="arguments">Arguments</h4>

<ul>
<li><em>succesCallback</em>optional</li>
</ul>

<p>Success callback. Called when function finished without errors</p>

<p>Callback parameter is always null</p>

<ul>
<li><em>errorCallback</em>optional</li>
</ul>

<p>Error Callback. Called when function return error.</p>

<h4 id="return-value">Return Value</h4>

<ul>
<li><em><a href="kernel_promise.html">RBCPromise</a> object</em></li>
</ul>

<h4 id="sample">Sample</h4>

<p><code class="prettyprint">btPeripheral.stopDiscovery( function() {  
    alert(&quot;Discovery Stopped.&quot;);  
}, function (error) {  
    alert(&quot;code: &quot; \+ error.code + &quot;\nmessage: &quot; \+ error.message);  
});</code>  </p>

<h3 id="connect">connect</h3>

<p><code class="prettyprint">btPeripheral.connect( peripheralId, successCallback, errorCallback )</code></p>

<h4 id="discussion">Discussion</h4>

<p>Tries to connect to peripheral device. Developer can monitor connection state
with btPeripheral.peripheralStateChanged event.</p>

<p>Also when connection established automatically starts receiving information
from supported GATT profiles. Developer must add listener for
btPeripheral.peripheralInfoChanged event to receive it.</p>

<h4 id="arguments">Arguments</h4>

<ul>
<li><em>peripheralId</em>required</li>
</ul>

<p>A String value. Idenfier of peripheral device.</p>

<ul>
<li><em>succesCallback</em>optional</li>
</ul>

<p>Success callback. Called when function finished without errors</p>

<p>Callback parameter is always null</p>

<ul>
<li><em>errorCallback</em>optional</li>
</ul>

<p>Error Callback. Called when function return error.</p>

<h4 id="return-value">Return Value</h4>

<ul>
<li><em><a href="kernel_promise.html">RBCPromise</a> object</em></li>
</ul>

<h4 id="sample">Sample</h4>

<p><code class="prettyprint">btPeripheral.connect( &quot;46c85837-cc6e-452f-a279-f4731cec164d&quot;, function(info)
{  
    alert(&quot;Peripheral connected.&quot;);  
}, function (error) {  
    alert(&quot;code: &quot; \+ error.code + &quot;\nmessage: &quot; \+ error.message);  
});</code>  </p>

<h3 id="disconnect">disconnect</h3>

<p><code class="prettyprint">btPeripheral.disconnect( peripheralId, successCallback, errorCallback )</code></p>

<h4 id="discussion">Discussion</h4>

<p>Disconnects from peripheral device.</p>

<h4 id="arguments">Arguments</h4>

<ul>
<li><em>peripheralId</em>required</li>
</ul>

<p>A String value. Idenfier of peripheral device.</p>

<ul>
<li><em>succesCallback</em>optional</li>
</ul>

<p>Success callback. Called when function finished without errors</p>

<p>Callback parameter is always null</p>

<ul>
<li><em>errorCallback</em>optional</li>
</ul>

<p>Error Callback. Called when function return error.</p>

<h4 id="return-value">Return Value</h4>

<ul>
<li><em><a href="kernel_promise.html">RBCPromise</a> object</em></li>
</ul>

<h4 id="sample">Sample</h4>

<p><code class="prettyprint">btPeripheral.disconnect( &quot;46c85837-cc6e-452f-a279-f4731cec164d&quot;,
function(info) {  
    alert(&quot;Peripheral disconnected.&quot;);  
}, function (error) {  
    alert(&quot;code: &quot; \+ error.code + &quot;\nmessage: &quot; \+ error.message);  
});</code>  </p>

<h2 id="events">Events</h2>

<h3 id="btperipheral.statechanged">btPeripheral.stateChanged</h3>

<h4 id="discussion">Discussion</h4>

<p>Event received when changed state of <a href="btPeripheral.html">BT Peripheral</a>
module. Working only between start and stop methods calls.</p>

<h4 id="callback-arguments">Callback Arguments</h4>

<ul>
<li><em>state</em> - New state. See STATES for more info. (Integer)</li>
</ul>

<h3 id="btperipheral.peripheralschanged">btPeripheral.peripheralsChanged</h3>

<h4 id="discussion">Discussion</h4>

<p>Event received when list of found peripherals changed. Working only between
startDiscovery and stopDiscovery methods calls.</p>

<h4 id="callback-arguments">Callback Arguments</h4>

<ul>
<li><em>peripherals</em> - The list of found peripheralInfo objects. (Array of Object)</li>
</ul>

<h3 id="btperipheral.peripheralstatechanged">btPeripheral.peripheralStateChanged</h3>

<h4 id="discussion">Discussion</h4>

<p>Event received when connection state of peripheral device changed.</p>

<h4 id="callback-arguments">Callback Arguments</h4>

<ul>
<li><em>peripheralId</em> - Idenfier of peripheral device. (String)</li>
<li><em>state</em> - New state. See CONNECTION_STATES for more info. (Integer)</li>
</ul>

<h3 id="btperipheral.peripheralinfochanged">btPeripheral.peripheralInfoChanged</h3>

<h4 id="discussion">Discussion</h4>

<p>Event received when supported GATT profile information received.</p>

<h4 id="callback-arguments">Callback Arguments</h4>

<ul>
<li><em>peripheralId</em> - Idenfier of peripheral device. (String)</li>
<li><p><em>info</em> - Updated profilesInfo. (Object)</p></li>
<li><p><a href="../index.html">Index</a></p></li>
</ul>

<hr>

<p>&copy; 2014 Red Book Connect. All rights reserved. (Last updated: 2014-06-25)</p>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
